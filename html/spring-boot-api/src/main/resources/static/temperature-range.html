<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Highcharts Lazy Loading Example</title>
    <!-- 修改 Highcharts 引入 -->
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/data.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <style>
        #container {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body>

<div>aa</div>
<div id="container"></div>
<script>
Highcharts.stockChart('container', {
    chart: {
        type: 'arearange',
        zooming: {
            type: 'x'
        },
        events: {
            load: function() {
                const chart = this;
                // 先加載主圖表數據
                fetch('/api/temperature/json?from=1&to=3')
                    .then(response => response.json())
                    .then(data => {
                        // 設置主圖表數據
                        chart.series[0].setData(data.helsinki);
                        chart.series[1].setData(data.turku);
                    });
            }
        }
    },
    plotOptions: {
        arearange: {
            grouping: false,
            dataGrouping: {
                enabled: false
            }
        }
    },
    scrollbar: {
        enabled: true
    },
    navigator: {
        enabled: true,
        height: 50,
        series: {
            type: 'areaspline',
            lineWidth: 1
        },
        marker: {
            enabled: false
        }
    },
    title: {
        text: 'Temperature variation by day',
        align: 'left'
    },
    subtitle: {
        text: 'Source: ' +
            '<a href="https://veret.gfi.uib.no/"' +
            'target="_blank">Universitetet i Bergen</a>',
        align: 'left'
    },
    xAxis: {
        type: 'datetime',
        accessibility: {
            rangeDescription: 'Range: Jan 1st 2023 to Jan 1st 2024.'
        }
    },
    yAxis: {
        title: {
            text: null
        }
    },
    tooltip: {
        crosshairs: true,
        shared: true,
        valueSuffix: '°C',
        xDateFormat: '%A, %b %e'
    },
    legend: {
        enabled: true,
        align: 'right',
        verticalAlign: 'top',
        layout: 'vertical'
    },
    series: [{
        name: 'Helsinki',
        showInNavigator: true,
        type: 'arearange'
    }, {
        name: 'Turku',
        showInNavigator: true,
        type: 'arearange'
    }]
});
</script>
</body>
</html>
